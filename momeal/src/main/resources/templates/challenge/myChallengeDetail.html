<!DOCTYPE html>
<html
    xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{frame/feed}">

    <head>
        <meta charset="UTF-8">
        <meta name="description" content="Ogani Template">
        <meta name="keywords" content="Ogani, unica, creative, html">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>My challenge</title>

        <!-- Google Font -->
        <link
            href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;900&display=swap"
            rel="stylesheet">

        <!-- Css Styles -->
        <link
            rel="stylesheet"
            href="/second-template/css/bootstrap.min.css"
            type="text/css">
        <link
            rel="stylesheet"
            href="/second-template/css/font-awesome.min.css"
            type="text/css">
        <!-- <link rel="stylesheet" href="/ogani-master/css/elegant-icons.css" -->
        <!-- type="text/css"> -->
        <!-- <link rel="stylesheet" href="/ogani-master/css/nice-select.css" -->
        <!-- type="text/css"> -->
        <!-- <link rel="stylesheet" href="/ogani-master/css/jquery-ui.min.css" -->
        <!-- type="text/css"> -->
        <!-- <link rel="stylesheet" href="/ogani-master/css/owl.carousel.min.css" -->
        <!-- type="text/css"> -->
        <!-- <link rel="stylesheet" href="/ogani-master/css/slicknav.min.css" -->
        <!-- type="text/css"> -->
        <link rel="stylesheet" href="/second-template/css/style.css" type="text/css">

        <!-- ë¦¬ë·° íƒ­ -->
        <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/assets/css/bootstrap.min_grp.css">
        <link rel="stylesheet" href="/assets/css/style_grp.css">

        <!-- ì¸ì¦ ëª¨ë‹¬ -->
        <link href="/modal-template/css/style.css" rel="stylesheet">

        <style>
            #reviewForm fieldset {
                display: inline-block;
                /* í•˜ìœ„ ë³„ì  ì´ë¯¸ì§€ë“¤ì´ ìˆëŠ” ì˜ì—­ë§Œ ìë¦¬ë¥¼ ì°¨ì§€í•¨.*/
                direction: rtl;
                /* ì´ëª¨ì§€ ìˆœì„œ ë°˜ì „ */
                border: 0;
                /* í•„ë“œì…‹ í…Œë‘ë¦¬ ì œê±° */
            }
            #reviewForm fieldset legend {
                text-align: left;
            }
            #reviewForm input[type=radio] {
                display: none;
                /* ë¼ë””ì˜¤ë°•ìŠ¤ ê°ì¶¤ */
            }
            #reviewForm label {
                font-size: 30px;
                /* ì´ëª¨ì§€ í¬ê¸° */
                color: transparent;
                /* ê¸°ì¡´ ì´ëª¨ì§€ ì»¬ëŸ¬ ì œê±° */
                text-shadow: 0 0 0 #f0f0f0;
                /* ìƒˆ ì´ëª¨ì§€ ìƒ‰ìƒ ë¶€ì—¬ */
            }
            #reviewForm label:hover {
                text-shadow: 0 0 0 #FFE324;
                /* ë§ˆìš°ìŠ¤ í˜¸ë²„ */
            }
            #reviewForm label:hover ~ label {
                text-shadow: 0 0 0 #FFE324;
                /* ë§ˆìš°ìŠ¤ í˜¸ë²„ ë’¤ì—ì˜¤ëŠ” ì´ëª¨ì§€ë“¤ */
            }
            #reviewForm input[type=radio]:checked ~ label {
                text-shadow: 0 0 0 #FFE324;
                /* ë§ˆìš°ìŠ¤ í´ë¦­ ì²´í¬ */
            }
        </style>
    </head>

    <body>
        <div layout:fragment="content">
            <!-- Product Details Section Begin -->
            <!-- <section class="product-details spad"> -->
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-md-6">
                        <div class="product__details__pic" align="center">
                            <!-- <div class="product__details__pic__item"> -->
                            <img
                                class="product__details__pic__item--large"
                                th:src="${chall.thumbnailImgPath}"
                                alt=""
                                style="width:330px; height:330px;">
                            <!-- </div> -->

                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6">
                        <div class="product__details__text" id="challInfo">
                            <h3>[[ ${chall.title} ]]</h3>
                            <p>[[ ${#dates.format(chall.chalStartDate, 'MM-dd')} ]]([[
								${#dates.dayOfWeekName(chall.chalStartDate)} ]]) ~ [[
								${#dates.format(chall.chalEndDate, 'MM-dd')} ]]([[
								${#dates.dayOfWeekName(chall.chalEndDate)} ]])</p>
							<th:block th:if="${chall.codeId == 'CL01'}">
								<br><br><br>
								<p style="color: red;"><b>[[${#numbers.formatInteger(chall.rewardPoint, 3, 'COMMA')}]]í¬ì¸íŠ¸ë¥¼ íšë“í–ˆì–´ìš”!</b></p>
							</th:block>
							<th:block th:if="${chall.codeId == 'CL02'}">
								<br><br><br>
								<p style="color: red;"><b>ì±Œë¦°ì§€ ì™„ì£¼ì— ì‹¤íŒ¨í–ˆì–´ìš”ğŸ˜¥</b></p>
							</th:block>
							<th:block th:if="${chall.codeId == '0'}">
	                            <p>[[ ${chall.totalDay} ]]ì¼ê°„ ì§„í–‰</p>
	                            <br><br>
							<br>
								<a href="#" class="heart-icon" data-toggle="modal"
									data-target="#Modal-1">ì¸ì¦ë°©ë²•</a> <a href="" class="primary-btn"
									data-toggle="modal" data-target="" onclick="modal()">ì¸ì¦í•˜ê¸°</a> <!-- data-target="#Modal-2" -->
							</th:block>
							<th:block th:unless="${chall.codeId == '0'}">
								<th:block th:if="${chall.reviewCheck == 0}">
									<a href="#" class="primary-btn"
										data-toggle="modal" data-target="#review" th:id="|reviewBtn${chall.no}|">í›„ê¸°ì“°ê¸°</a>
								</th:block>
								<th:block th:unless="${chall.reviewCheck == 0}">
									<a href="#" class="primary-btn"
										data-toggle="modal" data-target="#review" id="reviewBtn" th:onclick="reviewModal([[${chall.no}]])">í›„ê¸°ê´€ë¦¬</a>
								</th:block>
							</th:block>
						</div>
					</div>
					<div class="col-lg-12">
						<div class="product__details__tab">
							<ul class="nav nav-tabs" role="tablist">
								<li class="nav-item"><a class="nav-link active"
									data-toggle="tab" href="#myAuthentication" role="tab"
									aria-selected="true">ë‚˜ì˜ ì¸ì¦ í˜„í™©</a></li>
								<li class="nav-item"><a class="nav-link" data-toggle="tab"
									href="#authentication" role="tab" aria-selected="false">ì°¸ê°€ì
										ì¸ì¦ í˜„í™©</a></li>

							</ul>

							<!-- íƒ­ ë‚´ìš©ë“¤ -->
							<div class="tab-content">
								<!-- ë‚˜ì˜ ì±Œë¦°ì§€ íƒ­ ì‹œì‘ -->
								<div class="tab-pane active" id="myAuthentication"
									role="tabpanel">
									<div class="product__details__tab__desc">
										<div id="myPercent">
											<p>ë‹¬ì„±ë¥ </p>
											<h4>
												<b>[[ ${chall.percent} ]]%</b>
											</h4>
										</div>
										<br>
										<div class="row">
											<div class="text-center"></div>
											<div class="col-md-8">
												<!-- skill bar item -->
												<div class="skillbar-item">
													<div class="skillbar" id="myPercentBar" th:data-percent="${chall.percent}">
														<!-- ì—¬ê¸°... ë‹¬ì„±ë¥  %ë¡œ í•´ì•¼í•´.. -->
														<div class="skillbar-bar">
															<div class="skillbar-percent" style="width:50%;">
																<!-- ì—¬ê¸°... ë‹¬ì„±ë¥  %ë¡œ í•´ì•¼í•´.. -->
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<br>
										<div>
											<table>
												<thead>
													<tr align="center">
														<th style="padding-right: 30px">ì¸ì¦ì„±ê³µ</th>
														<th>ì „ì²´ íšŸìˆ˜</th>
													</tr>
												</thead>
												<tbody>
													<tr id="imageCount" th:data-challno="${chall.no}">
														<td><h4 id="successCheck"><b>[[ ${chall.success} ]]íšŒ</b></h4></td>
														<td><h4 id="totalCheck"><b>[[ ${chall.totalDay} ]]íšŒ</b></h4></td>
													<tr>
												</tbody>
											</table>
										</div>
										<br> <br> <br>
										<div>
											<h4>
												<b>ë‚˜ì˜ ì¸ì¦ìƒ·</b>
											</h4>

											<!-- ì¸ì¦ìƒ· ë°˜ë³µë¬¸ ëŒë¦¬ê¸° -->
											<div class="row row-0-gutter" id="myValImg">
												<div th:each="img : ${valImg}" class="col-md-3 col-0-gutter text-center">
													<div class="mz-module-about">
														<a href="#" data-toggle="modal" data-target="#imgDetail" th:onclick="imgDetail([[${img.no}]])">
															<img th:src="${img.fileDir}" style="width: 200px; height: 200px;">
														</a>
													</div>
												</div>
											</div>
											<!-- ì¸ì¦ìƒ· ë°˜ë³µë¬¸ ëŒë¦¬ê¸° ë -->

										</div>
									</div>
								</div>
								<!-- ë‚˜ì˜ ì±Œë¦°ì§€ íƒ­ ë -->

								<!-- ì±Œë¦°ì§€ ì°¸ê°€ì íƒ­ ì‹œì‘ -->
								<div class="tab-pane" id="authentication" role="tabpanel">
									<section id="about" class="mz-module">
										<div class="row">
											<div class="col-md-6">
												<div>
													<table>

														<tr>
															<th>í˜„ì¬ ì°¸ê°€ì ìˆ˜</th>
														</tr>
														<tr>
															<td><h4>
																	<b>[[ ${chall.particir} ]]ëª…</b>
																</h4></td>
														<tr>
														<tr>
															<td><br></td>
														</tr>
														<tr>
															<th>ëˆ„ì  ì°¸ê°€ì ìˆ˜</th>
														</tr>
														<tr>
															<td><h4>
																	<b>[[ ${chall.sumParticir} ]]ëª…</b>
																</h4></td>
														<tr>
													</table>
												</div>
											</div>
											<div class="col-md-6">
												<p style="color: gray;">
													<b>í‰ê·  ì˜ˆìƒ ë‹¬ì„±ë¥ </b>
												</p>
												<h4>
													<b>ì›í˜• ê·¸ë˜í”„ê°€ ë‚«ë‚˜..?</b>
												</h4>
												<br>
												<!-- skill bar item -->
												<div class="skillbar-item">
													<div class="skillbar" data-percent="70%">
														<h3>Marketing</h3>
														<div class="skillbar-bar">
															<div class="skillbar-percent" style="width: 70%;">
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<br>
										<br>
										<br>
										<div>
											<h4>
												<b>ì°¸ê°€ì ì¸ì¦ìƒ·</b>
											</h4>

											<!-- ì¸ì¦ìƒ· ë°˜ë³µë¬¸ ëŒë¦¬ê¸° -->
											<div class="row row-0-gutter" id="userValImg">
												<div th:each="userImg : ${userValImg}" class="col-md-3 col-0-gutter text-center">
													<div class="mz-module-about">
														<a href="#" data-toggle="modal" data-target="#imgDetail" th:onclick="imgDetail([[${userImg.no}]])">
															<img th:src="${userImg.fileDir}" style="width: 200px; height: 200px;">
														</a>
													</div>
												</div>
											</div>
											<!-- ì¸ì¦ìƒ· ë°˜ë³µë¬¸ ëŒë¦¬ê¸° ë -->

										</div>
									</section>
								</div>
								<!-- ì±Œë¦°ì§€ ì°¸ê°€ì íƒ­ ë -->
							</div>

							<!-- ì¸ì¦ë°©ë²• ëª¨ë‹¬ -->
							<div class="modal fade" id="Modal-1" tabindex="-1" role="dialog"
								aria-labelledby="Modal-label-1">
								<div class="modal-dialog" role="document">
									<div class="modal-content">
										<div class="modal-header">
											<h4 class="modal-title" id="Modal-label-1">ì±Œë¦°ì§€ ì¸ì¦ë°©ë²•</h4>
											<button type="button" class="close" data-dismiss="modal"
												aria-label="Close">
												<span aria-hidden="true">&times;</span>
											</button>
										</div>
										<div class="modal-body">
											<p>ì¸ì¦ë°©ë²• ì»¬ëŸ¼ì´ ìˆì–´ì•¼ í•  ê±° ê°™ì€ë°........?</p>
											<br>
											<p>
												<b>âœ… ì´ë ‡ê²Œ ì°ì–´ì£¼ì„¸ìš”</b>
											</p>
											<div align="center">
												<img th:src="${chall.thumbnailImgPath}" alt="img01"
													class="img-responsive" style="width: 300px; height: 300px;" />
											</div>
											<p>ìš”ë ‡ê²Œ ì°ì–´ë‹¬ë¼ëŠ” ì¸ì¦ë°©ë²• ì»¬ëŸ¼ë„ ìˆì–´ì•¼ í•  ê²ƒ ê°™ì€ë°..?ğŸ¤¦â€</p>
										</div>
									</div>
								</div>
							</div>
							<!-- ì¸ì¦ë°©ë²• ëª¨ë‹¬ ë -->

							<!-- ì¸ì¦ì°½ ëª¨ë‹¬ -->
							<form id="frm" method="post" enctype="multipart/form-data">
								<div class="modal fade" id="Modal-2" tabindex="-1" role="dialog"
									aria-labelledby="Modal-label-1">
									<div class="modal-dialog" role="document">
										<div class="modal-content">
											<div class="modal-header">
												<h4 class="modal-title" id="Modal-label-1">ì¸ì¦í•˜ê¸°</h4>
												<button type="button" class="close" data-dismiss="modal"
													aria-label="Close">
													<span aria-hidden="true">&times;</span>
												</button>
											</div>
											<div class="modal-body" id="myChallImgModal">
											<!-- ì¸ì¦ ì‚¬ì§„ ì²¨ë¶€ (scriptì—ì„œ ì²˜ë¦¬) -->
											</div>
											<div class="modal-footer">
												<button type="button" class="btn btn-default" id="uploadBtn" onclick="myChallImgInsert()">ë“±ë¡</button>
											</div>
											<input type="hidden" id="userId" name="userId" th:value="${session.userId}">
											<input type="hidden" id="chalNo" name="chalNo" th:value="${chall.no}">
										</div>
									</div>
								</div>
							</form>
							<!-- ì¸ì¦ì°½ ëª¨ë‹¬ ë -->
							
							<!-- ì¸ì¦ ì´ë¯¸ì§€ ìƒì„¸ í™•ì¸ ëª¨ë‹¬ -->
							<div class="modal fade" id="imgDetail" tabindex="-1" role="dialog"
								aria-labelledby="Modal-label-1">
								<div class="modal-dialog" role="document">
									<div class="modal-content">
										<div class="modal-header">
											<h4 class="modal-title" id="Modal-label-1">ì¸ì¦ì‚¬ì§„</h4>
											<button type="button" class="close" data-dismiss="modal"
												aria-label="Close">
												<span aria-hidden="true">&times;</span>
											</button>
										</div>
										<div class="modal-body">
											<p id="imgDate"></p>
											<p id="userNickName"></p>
											<img src="" alt="img01" id="oneImg"
												class="img-responsive" style="width: 500px; height: 500px;" />
											<th:block th:if="${session.userId} != ${chall.userId}">
											<div class="modal-works" align="right">
												<span>ì‹ ê³ </span>
											</div>
											</th:block>
										</div>
<!-- 										<div class="modal-footer"> -->
<!-- 											<button type="button" class="btn btn-default">ë‹«ê¸°</button> -->
<!-- 										</div> -->
									</div>
								</div>
							</div>
							<!-- ì¸ì¦ ì´ë¯¸ì§€ ìƒì„¸ í™•ì¸ ëª¨ë‹¬ ë -->
							
							
							<!-- í›„ê¸° ë“±ë¡ ëª¨ë‹¬ -->
							<form id="reviewForm" method="post">
								<div class="modal fade" id="review" tabindex="-1" role="dialog"
									aria-labelledby="Modal-label-1" align="center">
									<div class="modal-dialog" role="document">
										<div class="modal-content">
											<div class="modal-header">
												<h4 class="modal-title" id="Modal-label-1">í›„ê¸°</h4>
												<button type="button" class="close" data-dismiss="modal"
													aria-label="Close">
													<span aria-hidden="true">&times;</span>
												</button>
											</div>
											<div class="modal-body" id="myChallReview" style="padding:30px">
											    <fieldset>
											        <input type="radio" name="star" value="5" id="rate1"><label for="rate1">â­</label>
											        <input type="radio" name="star" value="4" id="rate2"><label for="rate2">â­</label>
											        <input type="radio" name="star" value="3" id="rate3"><label for="rate3">â­</label>
											        <input type="radio" name="star" value="2" id="rate4"><label for="rate4">â­</label>
											        <input type="radio" name="star" value="1" id="rate5"><label for="rate5">â­</label>
											    </fieldset>
											    <br><br>
											    <textarea id="subject" name="subject" rows="2" cols="10" placeholder="í›„ê¸°ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”."></textarea>
												<div id="text_cnt">(0 / 100)</div>
											</div>
											<div class="modal-footer">
												<th:block th:if="${chall.reviewCheck == 0}">
													<button type="button" class="btn btn-default" id="insertBtn" th:onclick="reviewInsert([[${chall.no}]])">ë“±ë¡</button>
												</th:block>
												<th:block th:unless="${chall.reviewCheck == 0}">
													<button type="button" class="btn btn-default" id="updateBtn" onclick="reviewUpdate()">ìˆ˜ì •</button>
													<button type="button" class="btn btn-default" id="deleteBtn" th:onclick="reviewDelete([[${chall.no}]])">ì‚­ì œ</button>
												</th:block>
											</div>
											<input type="hidden" id="userId" name="userId" th:value="${session.userId}">
											<input type="hidden" id="no" name="no" th:value="${chall.no}">
										</div>
									</div>
								</div>
							</form>
							<!-- í›„ê¸° ë“±ë¡ ë -->
						</div>
					</div>
				</div>
			</div>
			
			
		<script>
		// â–¶ ì¸ì¦í•˜ê¸° ë²„íŠ¼ í´ë¦­ì‹œ ë™ì‘
		function modal() {
			// ëª¨ë‹¬ì°½ bodyì˜ ë‚´ìš© ì§€ìš°ê¸°
			 $("#myChallImgModal").empty()
			 
			 // ëª¨ë‹¬ì°½ bodyì— ë‚ ì§œ ë„£ì„ íƒœê·¸, íŒŒì¼ì²¨ë¶€ ì°½ ìƒì„±
			 $("#myChallImgModal").append(
				`<p id="date"></p>
				<div style="padding: 10px;">
				<input type="file" id="file" name="file" onchange="preview(this)">
				</div>`
			 )
			
			// ì˜¤ëŠ˜ ë‚ ì§œ ê³„ì‚°í•˜ê¸°
			let today = new Date();   

			let year = today.getFullYear(); // ë…„ë„
			let month = today.getMonth() + 1;  // ì›”
			let date = today.getDate();  // ë‚ ì§œ

			// ê³„ì‚°í•œ ì˜¤ëŠ˜ ë‚ ì§œ ì¶œë ¥í•˜ê¸°
			$("#date").text(year + 'ë…„ ' + month + 'ì›” ' + date + 'ì¼')
			
			
			imgCheck()
			
		}
		
		
		// â–¶ ì²¨ë¶€íŒŒì¼ ë²„íŠ¼ í´ë¦­ì‹œ ë™ì‘
		function preview(obj) {

			// íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸
            if(!obj.files.length) {
                return;
            }
			
			// ê¸°ì¡´ ì²¨ë¶€íŒŒì¼ì´ ìˆë‹¤ë©´ ì§€ìš°ê¸°
			$("#file").parent().next().remove()
			
			// ë¯¸ë¦¬ë³´ê¸° ìƒì„± (ì´ë¯¸ì§€ íƒœê·¸ì˜ srcì— ì„ íƒí•œ íŒŒì¼ ë°ì´í„°ë¥¼ ë„£ì–´ì¤Œ)
			let reader = new FileReader();

			// 
            reader.readAsDataURL(obj.files[0]);
			
            reader.onload = function (data) {
            	let img = $('<img />');
//             	$(img).attr('id', 'myChallImg');
                $(img).attr('src', data.target.result);
                $(img).height(500);
                $(img).width(500);
                
                $("#myChallImgModal").append(img);
            }
		}
			
		// â–¶ ì¸ì¦ì‚¬ì§„ ë“±ë¡
		function myChallImgInsert() {
			// serialize ì™œ ì•ˆ ë¼....? formì— ìˆëŠ” userIdê°€ ë¬¸ìì—´ë¡œ ì•ˆ ë°”ê»´ì„œ ë„˜ì–´ê° ã… 
// 			let data = $('#frm').serialize();
// 			let data = $("form[id=frm]").serialize();

			var formData = new FormData($('#frm')[0])
			
			if(confirm("ì¸ì¦ì‚¬ì§„ì€ ë“±ë¡ í›„ ìˆ˜ì •, ì‚­ì œê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. \nì •ë§ë¡œ ë“±ë¡í•˜ì‹œê² ìŠµë‹ˆê¹Œ?") == true){ 
				   //trueëŠ” í™•ì¸ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ì½”ë“œ ì‘ì„±
				   alert("ì¸ì¦ì‚¬ì§„ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
			 }else{
			   // falseëŠ” ì·¨ì†Œë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ, ì·¨ì†Œë¨
			   return;
			 }
			
			// ajax ì²˜ë¦¬
			$.ajax({
				url: "/insertMyChallImg",
				type: "post",
				data: formData,
				contentType:false,
				processData:false,
			})
			.then(result => {
				console.log(result);
// 				$('#uploadBtn').attr('data-dismiss', 'modal');
				
				// ëª¨ë‹¬ì°½ ë‹«ê¸°
				$('#Modal-2').modal('hide');
				
				// insertí•œ ì¸ì¦ì‚¬ì§„ì„ ë¦¬ìŠ¤íŠ¸ì— ë¶™ì´ê¸°
				$("#myValImg").prepend(
					`
					<div class="col-md-3 col-0-gutter text-center">
						<div class="mz-module-about">
							<a href="#" data-toggle="modal" data-target="#imgDetail" onclick="imgDetail(${result.no})">
								<img src="${result.fileDir}" style="width: 200px; height: 200px;">
							</a>
						</div>
					</div>
					`
				)
				
				// ì¸ì¦ ì„±ê³µ íšŸìˆ˜ ì—…ë°ì´íŠ¸
				let success = $('#successCheck').text();
				let total = $('#totalCheck').text();
				
				success = Number(success.substring(0, success.length - 1)) + 1;
				total = Number(total.substring(0, total.length - 1));
				
				percent =  Math.ceil((success / total) * 100); 
				
				console.log(percent + "í¼ì„¼íŠ¸...............?")
				
				$('#myPercent').children().last().remove();
				$('#myPercent').append(
						`<h4><b>${percent}%</b></h4>`
				)
				$('#myPercentBar').data("percent", percent + "%")
				
				
				$('#imageCount').children().first().remove();
				$('#imageCount').prepend(
					`<td><h4 id="successCheck"><b>${success}íšŒ</b></h4></td>`
				)
				
			})
			
		}
		
		// â–¶ ì¸ì¦ì‚¬ì§„ ìƒì„¸
		function imgDetail(no) {
			
			$.ajax({
				url: "/myChallImg/" + no,
				type: "post",
			})
			.then(result => {
				console.log(result)
				$("#oneImg").attr("src", result.fileDir);
				$("#imgDate").text(result.vldDate);
				$("#userNickName").text(result.nickName);
			})
		}
		
		// â–¶ ì¸ì¦ ì¤‘ë³µì²´í¬
		function imgCheck() {
// 			debugger
			let chalNo = $("#imageCount").data("challno");
			
		   $.ajax({
			url: "/valImgCheck",
			type: "post",
			dataType: "json",
			data: {chalNo: chalNo}
		   })
		   .then(result => {
			   console.log(result)
			   
			   checkResult(result)
		   })
		   }
		
		// ì¤‘ë³µ ì—¬ë¶€ì— ë”°ë¼ ë³´ì—¬ì¤„ ê²ƒ
		function checkResult(data) {
// 		   console.log(data)
		   if(data == true) {
			   alert("ì˜¤ëŠ˜ ì¸ì¦ì„ ì´ë¯¸ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.")
			   
			   
		   }else if(data == false){
		      console.log(data)
		      $('#Modal-2').modal('show');
		   }
		}
		
		
		// â–¶ í›„ê¸° ê¸€ììˆ˜ ì œí•œ
		$(function() {
		    $('#subject').on('keyup', function() {
		        $('#text_cnt').html("(" + $(this).val().length + " / 100)");
		 
		        if($(this).val().length > 100) {
		            $(this).val($(this).val().substring(0, 100));
		            $('#text_cnt').html("(100 / 100)");
		        }
		    });
		});
		
		// â–¶ í›„ê¸° ë“±ë¡
		function reviewInsert(no) {
			let reviewInfo = $("form[id=reviewForm]").serialize();
			
			if($('input:radio[name="star"]').is(':checked') == false) {
				alert("ë³„ì ì„ ì„ íƒí•´ì£¼ì„¸ìš”.")
				return;
			}
			if($("#subject").val().length == 0) {
				alert("í›„ê¸° ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
				return;
			}
			
			$.ajax({
				url: "/insertReview",
				type: "post",
				data : reviewInfo,
				dataType : "json"
			})
			.then(result => {
				if(result != 0) {
					alert("í›„ê¸°ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.")
					
// 					// ëª¨ë‹¬ì°½ ë‹«ê¸°
// 					$("#review").modal("hide");
					
// 					// ë¦¬ë·°ì‘ì„± ë²„íŠ¼ ì‚­ì œ í›„ ë¦¬ë·°ê´€ë¦¬ ë²„íŠ¼ ë‹¬ê¸°
// 					$("#reviewBtn" + no).remove();
// 					$("#challInfo").append(
// 						`
// 						<a href="#" class="primary-btn"
// 						   data-toggle="modal" data-target="#review" id="reviewBtn" th:onclick="reviewModal(${no})">í›„ê¸°ê´€ë¦¬</a>
// 						`		
// 					)
					
					location.reload();
				}
			})
		}
		
		// â–¶ í›„ê¸°ê´€ë¦¬ ë²„íŠ¼ í´ë¦­ì‹œ í›„ê¸° ë‚´ìš© í˜¸ì¶œ
		function reviewModal(no) {
			$.ajax({
				url: "/challOneReview/" + no,
				type: "post"
			})
			.then(result => {
				$(":radio[name='star'][value='" + result.star + "']").attr('checked', true);
				$("#subject").val(result.subject);
			})
		}
		
		// â–¶ í›„ê¸° ìˆ˜ì •
		function reviewUpdate() {
			let reviewInfo = $("form[id=reviewForm]").serialize();
			
			$.ajax({
				url: "/updateReview",
				type: "post",
				data : reviewInfo,
				dataType : 'json'
			})
			.then(result => {
				alert("í›„ê¸°ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.")
				
// 				// ëª¨ë‹¬ì°½ ë‹«ê¸°
// 				$('#review').modal('hide');
				
				location.reload();
			})
		}
		
		// â–¶ í›„ê¸° ì‚­ì œ
		function reviewDelete(no) {
			let reviewInfo = $("form[id=reviewForm]").serialize();
			
			if(confirm("í›„ê¸°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?") == true){ 
				   //trueëŠ” í™•ì¸ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ì½”ë“œ ì‘ì„±
				   alert("í›„ê¸°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
			 }else{
			   // falseëŠ” ì·¨ì†Œë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ, ì·¨ì†Œë¨
			   return;
			 }
			
			$.ajax({
				url: "/deleteReview",
				type: "post",
				data : reviewInfo,
				dataType : 'json'
			})
			.then(result => {
// 				// ëª¨ë‹¬ì°½ ë‹«ê¸°
// 				$('#review').modal('hide');
				

				location.reload();
				
				// í›„ê¸°ê´€ë¦¬ ë²„íŠ¼ ì‚­ì œ í›„ í›„ê¸°ì“°ê¸° ë²„íŠ¼ ë‹¬ê¸°
// 				$("#reviewBtn").remove();
// 				$("#challInfo").append(
// 					`
// 					<a href="#" class="primary-btn"
// 						data-toggle="modal" data-target="#review" id="reviewBtn${no}">í›„ê¸°ì“°ê¸°</a>
// 					`		
// 				)
				
			})
		}
		

		
		</script>
<!-- 		</section> -->


		<!-- Js Plugins -->
<!-- 		<script src="/ogani-master/js/jquery-3.3.1.min.js"></script> -->
		<script src="/second-template/js/bootstrap.min.js"></script>
<!-- 		<script src="/ogani-master/js/jquery.nice-select.min.js"></script> -->
<!-- 		<script src="/ogani-master/js/jquery-ui.min.js"></script> -->
<!-- 		<script src="/ogani-master/js/jquery.slicknav.js"></script> -->
<!-- 		<script src="/ogani-master/js/mixitup.min.js"></script> -->
<!-- 		<script src="/ogani-master/js/owl.carousel.min.js"></script> -->
<!-- 		<script src="/ogani-master/js/main.js"></script> -->
	</div>
</body>

</html>